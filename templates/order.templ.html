{{define "order"}}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>orders</title>
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="stylesheet" href="/static/css/table.css">
    <link rel="stylesheet" href="/static/css/searchbar.css">
</head>

<body>
    <div class="container">
        <h1>{{.Task.ID}}: {{.Task.Objective}}</h1>

        <div>
            <a href="/order/{{.ParentOrderID}}">Parent Order:</a>
            <input list="orders" class="text-input" id="parent-order-id" name="order-task"
                value="{{.ParentOrderID}}: {{(ParentOrder .ParentOrderID).Task.Objective}}" />
            <datalist id="orders">
                {{range Orders}}
                <option value="{{.Task.ID}}: {{.Task.Objective}}">{{.Task.ID}}: {{.Task.Objective}}</option>
                {{end}}
            </datalist>
        </div>

        <div>
            <label for="task-objective">Objective:</label>
            <input type="text" class="text-input" id="task-objective" name="order-task" value="{{.Task.Objective}}" required>
        </div>

        <div>
            <a href="/user/{{.Task.Accountable.ID}}">Accountable:</a>
            <input list="users" class="text-input" id="task-accountable" name="order-task"
                value="{{.Task.Accountable.Email}}" />
            <datalist id="users">
                {{range UserEmails}}
                <option value="{{.}}">{{.}}</option>
                {{end}}
            </datalist>
        </div>

        <div>
            <label for="task-deadline">Deadline:</label>
            <input type="date" id="task-deadline" name="order-task" value="{{formatToDate .Task.Deadline}}" required>
        </div>

        <div>
            <label for="task-state">State:</label>
            <select id="task-state" name="order-task" required>
                {{range States}}
                <option value="{{.}}" {{if eq . $.Task.State}}selected{{end}}>{{.}}</option>
                {{end}}
            </select>
        </div>

        <details>
            <summary>Delegated Tasks</summary>
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Objective</th>
                        <th>Accountable</th>
                        <th>Deadline</th>
                    </tr>
                </thead>
                <tbody>
                    {{range .DelegatedTasks}}
                    <tr>
                        <td><a href="/order/{{.ID}}">{{.ID}}</a></td>
                        <td>{{.Objective}}</td>
                        <td><a href="/user/{{.Accountable.ID}}">{{.Accountable.Email}}</a></td>
                        <td><input type="date" value="{{formatToDate .Deadline}}" required disabled></td>
                    </tr>
                    {{end}}
                </tbody>
            </table>
        </details>

        <details>
            <summary>SitReps</summary>
            {{range .SitReps}}
            <div class="card">
                <div><strong>ID:</strong> {{.ID}}</div>
                <div><strong>By:</strong> <a href="/user/{{.By.ID}}">{{.By.Email}}</a></div>
                <div><strong>DateTime:</strong> {{formatToDate .DateTime}}</div>
                <div><strong>Ping:</strong>
                    {{range $index, $ping := .Ping}}
                    <a href="/user/{{.ID}}">{{.Email}}</a>
                    {{end}}
                </div>

                <div>
                    <label for="sitrep-situation-{{.ID}}">Situation:</label>
                    <input type="text" id="sitrep-situation-{{.ID}}" name="order-sitrep" value="{{.Situation}}">
                </div>

                <div>
                    <label for="sitrep-actions-{{.ID}}">Actions:</label>
                    <input type="text" id="sitrep-actions-{{.ID}}" name="order-sitrep" value="{{.Actions}}">
                </div>

                <div>
                    <label for="sitrep-tbd-{{.ID}}">TBD:</label>
                    <input type="text" id="sitrep-tbd-{{.ID}}" name="order-sitrep" value="{{.TBD}}">
                </div>

                <div>
                    <label for="sitrep-issues-{{.ID}}">Issues:</label>
                    <input type="text" id="sitrep-issues-{{.ID}}" name="order-sitrep" value="{{.Issues}}">
                </div>
            </div>
            {{end}}
        </details>
    </div>

    <script src="/static/scripts/datalist.js"></script>

</body>

</html>
{{end}}